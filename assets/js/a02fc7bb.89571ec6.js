"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[519],{9614:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>g,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var i=t(5893),s=t(1151);const r={},o="ENGINE",c={id:"engine",title:"ENGINE",description:"CLASSignite.engine.engine.Engine(process_function)",source:"@site/docs/engine.md",sourceDirName:".",slug:"/engine",permalink:"/pydocsite/docs/engine",draft:!1,unlisted:!1,editUrl:"https://github.com/brianjo/pydocsite/edit/main/website/docs/engine.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"Guide to Writing Docs and Tutorials",permalink:"/pydocsite/docs/doc3"},next:{title:"hello",permalink:"/pydocsite/docs/hello"}},a={},d=[{value:"<em>CLASS</em><code>ignite.engine.engine.Engine(</code><em><code>process_function</code></em><code>)</code>",id:"classigniteengineengineengineprocess_function",level:3},{value:"Examples",id:"examples",level:4}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"engine",children:"ENGINE"}),"\n",(0,i.jsxs)(n.h3,{id:"classigniteengineengineengineprocess_function",children:[(0,i.jsx)(n.em,{children:"CLASS"}),(0,i.jsx)(n.code,{children:"ignite.engine.engine.Engine("}),(0,i.jsx)(n.em,{children:(0,i.jsx)(n.code,{children:"process_function"})}),(0,i.jsx)(n.code,{children:")"})]}),"\n",(0,i.jsxs)(n.p,{children:["Runs a given ",(0,i.jsx)(n.code,{children:"process_function"})," over each batch of a dataset, emitting events as it goes.\nParameters"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"process_function"})," (",(0,i.jsx)(n.em,{children:"Callable[["}),(0,i.jsx)(n.a,{href:"https://pytorch.org/ignite/generated/ignite.engine.engine.Engine.html#ignite.engine.engine.Engine",children:(0,i.jsx)(n.em,{children:"Engine"})}),(0,i.jsx)(n.em,{children:", Any], Any]"}),") \u2013 A function receiving a handle to the engine and the current batch in each iteration, and returns data to be stored in the engine\u2019s state."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"state"}),"\nobject that is used to pass internal and user-defined state between event handlers. It is created with the engine and its attributes (e.g. ",(0,i.jsx)(n.code,{children:"state.iteration"}),", ",(0,i.jsx)(n.code,{children:"state.epoch"})," etc) are reset on every ",(0,i.jsx)(n.a,{href:"https://pytorch.org/ignite/generated/ignite.engine.engine.Engine.html#ignite.engine.engine.Engine.run",children:(0,i.jsx)(n.code,{children:"run()"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"last_event_name"}),"\nlast event name triggered by the engine."]}),"\n",(0,i.jsxs)(n.p,{children:["NOTE\n",(0,i.jsx)(n.a,{href:"https://pytorch.org/ignite/generated/ignite.engine.engine.Engine.html#ignite.engine.engine.Engine",children:(0,i.jsx)(n.code,{children:"Engine"})})," implementation has changed in v0.4.10 with \u201cinterrupt/resume\u201d feature. Engine may behave differently on certain corner cases compared to the one from v0.4.9 and before. In such case, you can set ",(0,i.jsx)(n.code,{children:"Engine.interrupt_resume_enabled = False"})," to restore previous behaviour."]}),"\n",(0,i.jsx)(n.h4,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"Create a basic trainer"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\ndef update_model(engine, batch):\n    inputs, targets = batch\n    optimizer.zero_grad()\n    outputs = model(inputs)\n    loss = criterion(outputs, targets)\n    loss.backward()\n    optimizer.step()\n    return loss.item()\n\ntrainer = Engine(update_model)\n\n@trainer.on(Events.ITERATION_COMPLETED(every=100))\ndef log_training(engine):\n    batch_loss = engine.state.output\n    lr = optimizer.param_groups[0]['lr']\n    e = engine.state.epoch\n    n = engine.state.max_epochs\n    i = engine.state.iteration\n    print(f\"Epoch {e}/{n} : {i} - batch loss: {batch_loss}, lr: {lr}\")\n\ntrainer.run(data_loader, max_epochs=5)\n\n> Epoch 1/5 : 100 - batch loss: 0.10874069479016124, lr: 0.01\n> ...\n> Epoch 2/5 : 1700 - batch loss: 0.4217900575859437, lr: 0.01\n"})})]})}function g(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>o});var i=t(7294);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);